// Generated by CoffeeScript 2.0.1
(function() {
  var Kitten, Schema, app, db, express, fluffy, kittySchema, mongoose, port, silence, uri;

  mongoose = require('mongoose');

  express = require('express');

  app = express();

  uri = process.env.DB_URI;

  port = process.env.PORT || 3000;

  mongoose.connect(uri);

  db = mongoose.connection;

  db.on('error', console.error.bind(console, 'connection error:'));

  db.on('open', function() {
    return `Connected to ${uri}`;
  });

  ({Schema} = require('mongoose'));

  kittySchema = Schema({
    name: String
  });

  kittySchema.methods.speak = function() {
    var greeting;
    return greeting = this.name ? `Meow name is ${this.name}.` : "I don't have a name.";
  };

  Kitten = mongoose.model('Kitten', kittySchema);

  silence = new Kitten({
    name: 'Silence'
  });

  console.log(silence.name);

  console.log(silence.speak());

  fluffy = new Kitten({
    name: 'fluffy'
  });

  fluffy.save(function(error, fluffy) {
    if (error) {
      return console.error(error);
    } else {
      return Kitten.find({
        name: /^fluff/
      }, function(error, kittens) {
        return console.log(kittens);
      });
    }
  });

  app.set('view engine', 'pug');

  app.get('/', function(request, response) {
    return response.render('index', {
      title: 'Some title',
      message: 'Some message.'
    });
  });

  app.listen(port);

}).call(this);
